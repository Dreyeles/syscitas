<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: head"></head>
<body class="bg-light">
  <!-- Header -->
  <div th:replace="fragments/header :: header"></div>
  
  <!-- Navbar -->
  <div th:replace="fragments/header :: navbar"></div>

  <!-- Main Content -->
  <main class="container py-5">
    <div class="row justify-content-center">
      <div class="col-lg-8">
        <div class="card shadow border-0 p-4">
          <h1 class="mb-4 text-center" style="font-family:'Poppins',Arial,sans-serif;font-weight:700;color:#0A7A8A;font-size:2rem;">Registro de Paciente</h1>
          
          <form id="registroPacienteForm">
            <!-- Sección 1: Información Personal -->
            <div class="mb-4">
              <h4 class="mb-3" style="color: var(--dark-color); border-bottom: 2px solid #0A7A8A; padding-bottom: 0.5rem;">
                <i class="bi bi-person-circle me-2"></i>Información Personal
              </h4>
              
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="dni" class="form-label" style="color: var(--dark-color);">DNI *</label>
                  <input type="text" class="form-control" id="dni" required maxlength="8" minlength="8">
                  <div class="invalid-feedback">El DNI debe tener exactamente 8 dígitos.</div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="fechaNacimiento" class="form-label" style="color: var(--dark-color);">Fecha de Nacimiento *</label>
                  <input type="date" class="form-control" id="fechaNacimiento" required>
                  <div class="invalid-feedback">Debes ser mayor de 18 años.</div>
                </div>
              </div>
              
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="nombres" class="form-label" style="color: var(--dark-color);">Nombres *</label>
                  <input type="text" class="form-control" id="nombres" required>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="apellidos" class="form-label" style="color: var(--dark-color);">Apellidos *</label>
                  <input type="text" class="form-control" id="apellidos" required>
                </div>
              </div>
              
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label class="form-label" style="color: var(--dark-color);">Sexo *</label>
                  <div class="mt-2">
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="sexo" id="sexoMasculino" value="masculino" required>
                      <label class="form-check-label" for="sexoMasculino" style="color: var(--dark-color);">Masculino</label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="sexo" id="sexoFemenino" value="femenino">
                      <label class="form-check-label" for="sexoFemenino" style="color: var(--dark-color);">Femenino</label>
                    </div>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="estadoCivil" class="form-label" style="color: var(--dark-color);">Estado Civil *</label>
                  <select class="form-select" id="estadoCivil" required>
                    <option value="">Seleccione...</option>
                    <option value="soltero">Soltero</option>
                    <option value="casado">Casado</option>
                    <option value="divorciado">Divorciado</option>
                    <option value="viudo">Viudo</option>
                  </select>
                </div>
              </div>
            </div>

            <!-- Sección 2: Ubicación y Contactos -->
            <div class="mb-4">
              <h4 class="mb-3" style="color: var(--dark-color); border-bottom: 2px solid #0A7A8A; padding-bottom: 0.5rem;">
                <i class="bi bi-geo-alt me-2"></i>Ubicación y Contactos
              </h4>
              
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="telefono" class="form-label" style="color: var(--dark-color);">Teléfono *</label>
                  <input type="tel" class="form-control" id="telefono" required minlength="9">
                  <div class="invalid-feedback">El teléfono debe tener al menos 9 dígitos.</div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="correo" class="form-label" style="color: var(--dark-color);">Correo Electrónico *</label>
                  <input type="email" class="form-control" id="correo" required>
                </div>
              </div>
              
              <div class="row">
                <div class="col-12 mb-3">
                  <label for="direccion" class="form-label" style="color: var(--dark-color);">Dirección *</label>
                  <input type="text" class="form-control" id="direccion" required>
                </div>
              </div>
              
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="contactoEmergenciaNombre" class="form-label" style="color: var(--dark-color);">Nombre del Contacto de Emergencia *</label>
                  <input type="text" class="form-control" id="contactoEmergenciaNombre" required>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="contactoEmergenciaTelefono" class="form-label" style="color: var(--dark-color);">Teléfono del Contacto de Emergencia *</label>
                  <input type="tel" class="form-control" id="contactoEmergenciaTelefono" required minlength="9">
                  <div class="invalid-feedback">El teléfono debe tener al menos 9 dígitos.</div>
                </div>
              </div>
            </div>

            <!-- Sección 3: Acceso a la Cuenta -->
            <div class="mb-4">
              <h4 class="mb-3" style="color: var(--dark-color); border-bottom: 2px solid #0A7A8A; padding-bottom: 0.5rem;">
                <i class="bi bi-shield-lock me-2"></i>Acceso a la Cuenta
              </h4>
              
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="password" class="form-label" style="color: var(--dark-color);">Contraseña *</label>
                  <input type="password" class="form-control" id="password" required minlength="8">
                  <div class="invalid-feedback">La contraseña debe tener al menos 8 caracteres.</div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="confirmPassword" class="form-label" style="color: var(--dark-color);">Confirmar Contraseña *</label>
                  <input type="password" class="form-control" id="confirmPassword" required>
                  <div class="invalid-feedback">Las contraseñas no coinciden.</div>
                </div>
              </div>
            </div>

            <!-- Sección 4: Información Médica Inicial (Opcional) -->
            <div class="mb-4">
              <h4 class="mb-3" style="color: var(--dark-color); border-bottom: 2px solid #0A7A8A; padding-bottom: 0.5rem;">
                <i class="bi bi-heart-pulse me-2"></i>Información Médica Inicial (Opcional)
              </h4>
              
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="grupoSanguineo" class="form-label" style="color: var(--dark-color);">Grupo Sanguíneo</label>
                  <select class="form-select" id="grupoSanguineo">
                    <option value="">Seleccione...</option>
                    <option value="A+">A+</option>
                    <option value="A-">A-</option>
                    <option value="B+">B+</option>
                    <option value="B-">B-</option>
                    <option value="AB+">AB+</option>
                    <option value="AB-">AB-</option>
                    <option value="O+">O+</option>
                    <option value="O-">O-</option>
                  </select>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="alergias" class="form-label" style="color: var(--dark-color);">Alergias</label>
                  <textarea class="form-control" id="alergias" rows="3" placeholder="Especifica tus alergias (opcional)..."></textarea>
                </div>
              </div>
            </div>

            <!-- Botones -->
            <div class="d-grid gap-2">
              <button type="submit" class="btn btn-lg" style="background-color: #0A7A8A; color: var(--light-color); border: none;">Registrarse</button>
              <a href="/inicio" class="btn" style="background-color: #5A6268; color: var(--light-color); border: none;">Volver al inicio</a>
            </div>
          </form>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <div th:replace="fragments/footer :: footer"></div>

  <!-- Scripts -->
  <script th:src="@{/js/bootstrap.bundle.min.js}"></script>
  <script th:src="@{/js/navbar.js}"></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.getElementById('registroPacienteForm');
      
      // Validación de DNI
      const dniInput = document.getElementById('dni');
      dniInput.addEventListener('input', function() {
        const dni = this.value.replace(/\D/g, '');
        this.value = dni;
        
        if (dni.length === 8) {
          this.classList.remove('is-invalid');
          this.classList.add('is-valid');
        } else {
          this.classList.remove('is-valid');
          if (dni.length > 0) {
            this.classList.add('is-invalid');
          }
        }
      });
      
      // Validación de teléfonos
      const telefonoInputs = [document.getElementById('telefono'), document.getElementById('contactoEmergenciaTelefono')];
      telefonoInputs.forEach(input => {
        input.addEventListener('input', function() {
          const telefono = this.value.replace(/\D/g, '');
          this.value = telefono;
          
          if (telefono.length >= 9) {
            this.classList.remove('is-invalid');
            this.classList.add('is-valid');
          } else {
            this.classList.remove('is-valid');
            if (telefono.length > 0) {
              this.classList.add('is-invalid');
            }
          }
        });
      });
      
      // Validación de contraseñas
      const passwordInput = document.getElementById('password');
      const confirmPasswordInput = document.getElementById('confirmPassword');
      
      function validatePasswords() {
        if (passwordInput.value.length >= 8) {
          passwordInput.classList.remove('is-invalid');
          passwordInput.classList.add('is-valid');
        } else {
          passwordInput.classList.remove('is-valid');
          if (passwordInput.value.length > 0) {
            passwordInput.classList.add('is-invalid');
          }
        }
        
        if (confirmPasswordInput.value === passwordInput.value && passwordInput.value.length >= 8) {
          confirmPasswordInput.classList.remove('is-invalid');
          confirmPasswordInput.classList.add('is-valid');
        } else {
          confirmPasswordInput.classList.remove('is-valid');
          if (confirmPasswordInput.value.length > 0) {
            confirmPasswordInput.classList.add('is-invalid');
          }
        }
      }
      
      passwordInput.addEventListener('input', validatePasswords);
      confirmPasswordInput.addEventListener('input', validatePasswords);
      
      // Validación de edad
      const fechaNacimientoInput = document.getElementById('fechaNacimiento');
      fechaNacimientoInput.addEventListener('change', function() {
        const fechaNacimiento = new Date(this.value);
        const hoy = new Date();
        const edad = hoy.getFullYear() - fechaNacimiento.getFullYear();
        const mes = hoy.getMonth() - fechaNacimiento.getMonth();
        
        if (mes < 0 || (mes === 0 && hoy.getDate() < fechaNacimiento.getDate())) {
          edad--;
        }
        
        if (edad >= 18) {
          this.classList.remove('is-invalid');
          this.classList.add('is-valid');
        } else {
          this.classList.remove('is-valid');
          this.classList.add('is-invalid');
        }
      });
      
      // Envío del formulario
      form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Simular envío exitoso
        alert('¡Registro exitoso! Tu cuenta ha sido creada correctamente.');
        window.location.href = '/inicio';
      });
    });
  </script>
</body>
</html> 