<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SISOL - Dashboard Administrativo</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <!-- Librerías para Citas -->
    <link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css" rel="stylesheet">
</head>
<body th:attr="data-user-role=${usuario.rol.name()}">
    <!-- Sidebar -->
    <div th:replace="~{fragments/sidebar :: sidebar}"></div>

    <!-- Navbar -->
    <div th:replace="~{fragments/nav-sisol :: nav-sisol}"></div>

    <!-- Workspace Container -->
    <section class="workspace" style="margin-left: 250px; margin-top: 56px; height: calc(100vh - 56px); overflow-y: auto;">
        
        <!-- Sistema de Tabs Bootstrap -->
        <div class="container-fluid p-4">
            
            <!-- Tabs para Personal Administrativo -->
            <ul th:if="${usuario.rol.name() == 'ROLE_PERSONAL_ADMINISTRATIVO'}" class="nav nav-tabs d-none" id="workspace-tabs-admin" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="dashboard-tab" data-bs-toggle="tab" data-bs-target="#dashboard" type="button" role="tab" aria-controls="dashboard" aria-selected="true">
                        <i class="bi bi-house-door me-2"></i>Dashboard
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="agendar-cita-tab" data-bs-toggle="tab" data-bs-target="#agendar-cita" type="button" role="tab" aria-controls="agendar-cita" aria-selected="false">
                        <i class="bi bi-calendar-plus me-2"></i>Agendar Cita
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="calendario-citas-tab" data-bs-toggle="tab" data-bs-target="#calendario-citas" type="button" role="tab" aria-controls="calendario-citas" aria-selected="false">
                        <i class="bi bi-calendar-week me-2"></i>Calendario Citas
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="medicos-tab" data-bs-toggle="tab" data-bs-target="#medicos" type="button" role="tab" aria-controls="medicos" aria-selected="false">
                        <i class="bi bi-person-badge me-2"></i>Médicos
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="consultar-tab" data-bs-toggle="tab" data-bs-target="#consultar" type="button" role="tab" aria-controls="consultar" aria-selected="false">
                        <i class="bi bi-search me-2"></i>Consultar
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="reporte-especialidad-tab" data-bs-toggle="tab" data-bs-target="#reporte-especialidad" type="button" role="tab" aria-controls="reporte-especialidad" aria-selected="false">
                        <i class="bi bi-file-earmark-text me-2"></i>Reporte Especialidades
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="agregar-especialidad-tab" data-bs-toggle="tab" data-bs-target="#agregar-especialidad" type="button" role="tab" aria-controls="agregar-especialidad" aria-selected="false">
                        <i class="bi bi-plus-circle me-2"></i>Agregar Especialidad
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="reporte-servicios-tab" data-bs-toggle="tab" data-bs-target="#reporte-servicios" type="button" role="tab" aria-controls="reporte-servicios" aria-selected="false">
                        <i class="bi bi-file-earmark-text me-2"></i>Reporte Servicios
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="agregar-servicio-tab" data-bs-toggle="tab" data-bs-target="#agregar-servicio" type="button" role="tab" aria-controls="agregar-servicio" aria-selected="false">
                        <i class="bi bi-plus-circle me-2"></i>Agregar Servicio
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="reporte-pacientes-tab" data-bs-toggle="tab" data-bs-target="#reporte-pacientes" type="button" role="tab" aria-controls="reporte-pacientes" aria-selected="false">
                        <i class="bi bi-file-earmark-text me-2"></i>Reporte Pacientes
                    </button>
                </li>

                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="añadir-paciente-tab" data-bs-toggle="tab" data-bs-target="#añadir-paciente" type="button" role="tab" aria-controls="añadir-paciente" aria-selected="false">
                        <i class="bi bi-person-plus me-2"></i>Añadir Paciente
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="agregar-personal-tab" data-bs-toggle="tab" data-bs-target="#agregar-personal" type="button" role="tab" aria-controls="agregar-personal" aria-selected="false">
                        <i class="bi bi-person-plus me-2"></i>Registrar Personal
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="consultar-personal-tab" data-bs-toggle="tab" data-bs-target="#consultar-personal" type="button" role="tab" aria-controls="consultar-personal" aria-selected="false">
                        <i class="bi bi-search me-2"></i>Consultar Personal
                    </button>
                </li>
            </ul>
            
            <!-- Tabs para Médicos -->
            <ul th:if="${usuario.rol.name() == 'ROLE_MEDICO'}" class="nav nav-tabs d-none" id="workspace-tabs-medico" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="dashboard-tab" data-bs-toggle="tab" data-bs-target="#dashboard" type="button" role="tab" aria-controls="dashboard" aria-selected="true">
                        <i class="bi bi-house-door me-2"></i>Dashboard
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="agenda-atencion-tab" data-bs-toggle="tab" data-bs-target="#agenda-atencion" type="button" role="tab" aria-controls="agenda-atencion" aria-selected="false">
                        <i class="bi bi-calendar-week me-2"></i>Agenda de Atención Médica
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="registro-atencion-tab" data-bs-toggle="tab" data-bs-target="#registro-atencion" type="button" role="tab" aria-controls="registro-atencion" aria-selected="false">
                        <i class="bi bi-journal-plus me-2"></i>Registro de Atención Médica
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="consultar-historial-tab" data-bs-toggle="tab" data-bs-target="#consultar-historial" type="button" role="tab" aria-controls="consultar-historial" aria-selected="false">
                        <i class="bi bi-search me-2"></i>Consultar Historial Clínico
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="registrar-historial-tab" data-bs-toggle="tab" data-bs-target="#registrar-historial" type="button" role="tab" aria-controls="registrar-historial" aria-selected="false">
                        <i class="bi bi-plus-circle me-2"></i>Registrar Historial Clínico
                    </button>
                </li>
            </ul>

            <!-- Contenido de Tabs -->
            <div class="tab-content" id="workspace-tab-content">
                
                <!-- Tab Dashboard -->
                <div class="tab-pane fade show active" id="dashboard" role="tabpanel" aria-labelledby="dashboard-tab" tabindex="0">
                    <!-- Dashboard según el rol del usuario -->
                    <div th:if="${usuario.rol.name() == 'ROLE_PERSONAL_ADMINISTRATIVO'}" th:replace="~{pages/personal_administrativo/main-dashboard :: main-dashboard}"></div>
                    <div th:if="${usuario.rol.name() == 'ROLE_MEDICO'}" th:replace="~{pages/medico/main-dashboard-medico :: main-dashboard-medico}"></div>
                </div>
                
                <!-- Tab Agendar Cita -->
                <div class="tab-pane fade" id="agendar-cita" role="tabpanel" aria-labelledby="agendar-cita-tab" tabindex="0">
                    <div th:replace="~{pages/personal_administrativo/citas/agendar-cita :: agendar-cita}"></div>
                </div>
                
                <!-- Tab Calendario Citas -->
                <div class="tab-pane fade" id="calendario-citas" role="tabpanel" aria-labelledby="calendario-citas-tab" tabindex="0">
                    <div th:replace="~{pages/personal_administrativo/citas/calendario-citas :: calendario-citas}"></div>
                </div>
                
                <!-- Tab Médicos -->
                <div class="tab-pane fade" id="medicos" role="tabpanel" aria-labelledby="medicos-tab" tabindex="0">
                    <div th:replace="~{pages/personal_administrativo/medicos/registro-medico :: registro-medico}"></div>
                </div>
                
                <!-- Tab Consultar -->
                <div class="tab-pane fade" id="consultar" role="tabpanel" aria-labelledby="consultar-tab" tabindex="0">
                    <div th:replace="~{pages/personal_administrativo/medicos/consultar-medico :: consultar-medico}"></div>
                </div>
                
                <!-- Tab Reporte Especialidades -->
                <div class="tab-pane fade" id="reporte-especialidad" role="tabpanel" aria-labelledby="reporte-especialidad-tab" tabindex="0">
                    <div th:replace="~{pages/personal_administrativo/especialidades/reporte-especialidad :: reporte-especialidad}"></div>
                </div>
                
                <!-- Tab Agregar Especialidad -->
                <div class="tab-pane fade" id="agregar-especialidad" role="tabpanel" aria-labelledby="agregar-especialidad-tab" tabindex="0">
                    <div th:replace="~{pages/personal_administrativo/especialidades/agregar-especialidad :: agregar-especialidad}"></div>
                </div>
                
                <!-- Tab Reporte Servicios -->
                <div class="tab-pane fade" id="reporte-servicios" role="tabpanel" aria-labelledby="reporte-servicios-tab" tabindex="0">
                    <div th:replace="~{pages/personal_administrativo/servicios/reporte-servicios :: reporte-servicios}"></div>
                </div>
                
                <!-- Tab Agregar Servicio -->
                <div class="tab-pane fade" id="agregar-servicio" role="tabpanel" aria-labelledby="agregar-servicio-tab" tabindex="0">
                    <div th:replace="~{pages/personal_administrativo/servicios/agregar-servicio :: agregar-servicio}"></div>
                </div>
                
                <!-- Tab Reporte Pacientes -->
                <div class="tab-pane fade" id="reporte-pacientes" role="tabpanel" aria-labelledby="reporte-pacientes-tab" tabindex="0">
                    <div th:replace="~{pages/personal_administrativo/pacientes/reporte-pacientes :: reporte-pacientes}"></div>
                </div>
                

                
                <!-- Tab Añadir Paciente -->
                <div class="tab-pane fade" id="añadir-paciente" role="tabpanel" aria-labelledby="añadir-paciente-tab" tabindex="0">
                    <div th:replace="~{pages/personal_administrativo/pacientes/añadir-paciente :: añadir-paciente}"></div>
                </div>
                
                <!-- Tab Agregar Personal -->
                <div class="tab-pane fade" id="agregar-personal" role="tabpanel" aria-labelledby="agregar-personal-tab" tabindex="0">
                    <div th:replace="~{pages/personal_administrativo/administrativos/agregar-personal :: agregar-personal}"></div>
                </div>
                
                <!-- Tab Consultar Personal -->
                <div class="tab-pane fade" id="consultar-personal" role="tabpanel" aria-labelledby="consultar-personal-tab" tabindex="0">
                    <div th:replace="~{pages/personal_administrativo/administrativos/consultar-personal :: consultar-personal}"></div>
                </div>
                
                <!-- ===== TABS PARA MÉDICOS ===== -->
                
                <!-- Tab Agenda de Atención Médica -->
                <div class="tab-pane fade" id="agenda-atencion" role="tabpanel" aria-labelledby="agenda-atencion-tab" tabindex="0">
                    <div class="container-fluid">
                        <h2 class="mb-4">Agenda de Atención Médica</h2>
                        <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body">
                                        <p class="text-muted">Aquí se mostrará la agenda de atención médica del doctor.</p>
                                        <!-- Contenido específico para agenda de atención médica -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Tab Registro de Atención Médica -->
                <div class="tab-pane fade" id="registro-atencion" role="tabpanel" aria-labelledby="registro-atencion-tab" tabindex="0">
                    <div class="container-fluid">
                        <h2 class="mb-4">Registro de Atención Médica</h2>
                        <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body">
                                        <p class="text-muted">Aquí se podrá registrar la atención médica a pacientes.</p>
                                        <!-- Contenido específico para registro de atención médica -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Tab Consultar Historial Clínico -->
                <div class="tab-pane fade" id="consultar-historial" role="tabpanel" aria-labelledby="consultar-historial-tab" tabindex="0">
                    <div class="container-fluid">
                        <h2 class="mb-4">Consultar Historial Clínico</h2>
                        <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body">
                                        <p class="text-muted">Aquí se podrá consultar el historial clínico de los pacientes.</p>
                                        <!-- Contenido específico para consultar historial clínico -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Tab Registrar Historial Clínico -->
                <div class="tab-pane fade" id="registrar-historial" role="tabpanel" aria-labelledby="registrar-historial-tab" tabindex="0">
                    <div class="container-fluid">
                        <h2 class="mb-4">Registrar Historial Clínico</h2>
                        <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body">
                                        <p class="text-muted">Aquí se podrá registrar el historial clínico de los pacientes.</p>
                                        <!-- Contenido específico para registrar historial clínico -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
    </section>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <!-- Librerías JavaScript para Citas -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/locales/es.js"></script>
    <!-- Script del sidebar - debe cargarse antes que los scripts específicos -->
    <script src="/js/sidebar.js"></script>
    <!-- Scripts según el rol del usuario -->
    <script th:if="${usuario.rol.name() == 'ROLE_PERSONAL_ADMINISTRATIVO'}" src="/js/admin.js"></script>
    <script th:if="${usuario.rol.name() == 'ROLE_PERSONAL_ADMINISTRATIVO'}" src="/js/admin-especialidad.js"></script>
    <script th:if="${usuario.rol.name() == 'ROLE_MEDICO'}" src="/js/medicos.js"></script>
    
    <style>
        /* Ocultar visualmente los nav-tabs pero mantener funcionalidad */
        .nav-tabs {
            display: none !important;
        }
        
        /* Animaciones suaves para los tabs */
        .tab-content {
            padding-top: 0;
        }
        
        .tab-pane {
            transition: opacity 0.3s ease;
        }
        
        /* Responsive para móviles */
        @media (max-width: 768px) {
            .workspace {
                margin-left: 0;
            }
        }
        
        /* Estilos específicos para el dashboard médico */
        .border-left-primary {
            border-left: 0.25rem solid #4e73df !important;
        }
        
        .border-left-success {
            border-left: 0.25rem solid #1cc88a !important;
        }
        
        .border-left-info {
            border-left: 0.25rem solid #36b9cc !important;
        }
        
        .border-left-warning {
            border-left: 0.25rem solid #f6c23e !important;
        }
        
        .text-gray-800 {
            color: #5a5c69 !important;
        }
        
        .text-gray-300 {
            color: #dddfeb !important;
        }
        
        .btn-block {
            display: block;
            width: 100%;
        }
        
        .card {
            position: relative;
            display: flex;
            flex-direction: column;
            min-width: 0;
            word-wrap: break-word;
            background-color: #fff;
            background-clip: border-box;
            border: 1px solid #e3e6f0;
            border-radius: 0.35rem;
        }
        
        .card-header {
            padding: 0.75rem 1.25rem;
            margin-bottom: 0;
            background-color: #f8f9fc;
            border-bottom: 1px solid #e3e6f0;
        }
        
        .shadow {
            box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.15) !important;
        }
    </style>
</body>
</html>